{"ast":null,"code":"import axios from\"axios\";import React,{createContext,useContext,useEffect,useState}from\"react\";import{tokenContext}from\"./AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";export const addCart=/*#__PURE__*/createContext();export default function AddProductToCartProvider(_ref){let{children}=_ref;const{token}=useContext(tokenContext);const[numberOfCartItem,setNumberOfCartItem]=useState(0);const[totalPrice,setTotalPrice]=useState(0);const[allProducts,setallProducts]=useState(null);const[cartId,setCartId]=useState(null);const[userId,setUserId]=useState(null);async function getProductFromCart(){try{await axios.get(\"https://ecommerce.routemisr.com/api/v1/cart\",{headers:{token:localStorage.getItem(\"tkn\")}}).then(res=>{setallProducts(res.data.data.products);setTotalPrice(res.data.data.totalCartPrice);setNumberOfCartItem(res.data.numOfCartItems);setCartId(res.data.data._id);setUserId(res.data.data.cartOwner);localStorage.setItem(\"userId\",res.data.data.cartOwner);});}catch(err){console.error(\"err\"+err);}}useEffect(()=>{getProductFromCart();},[token]);async function addProductToCart(productId){try{const{data}=await axios.post(\"https://ecommerce.routemisr.com/api/v1/cart\",{productId},{headers:{token:localStorage.getItem(\"tkn\")}});// setNumberOfCartItem(data.numOfCartItems);\n// setTotalPrice(data.totalCartPrice);\n// setallProducts(data.products);\ngetProductFromCart();return data;}catch(error){console.error(\"Error adding product to cart:\",error);throw new Error(\"Failed to add product to cart\");}}async function updateProductToCart(id,newCount){try{const boolenflag=await axios.put(\"https://ecommerce.routemisr.com/api/v1/cart/\".concat(id),{count:newCount},{headers:{token:localStorage.getItem(\"tkn\")}}).then(res=>{setallProducts(res.data.data.products);setTotalPrice(res.data.data.totalCartPrice);setNumberOfCartItem(res.data.numOfCartItems);setUserId(res.data.data.cartOwner);return true;}).catch(err=>{console.log(err);return false;});return boolenflag;}catch(error){console.log(error);}}async function deleteItemFromCart(id){try{const boolenData=await axios.delete(\"https://ecommerce.routemisr.com/api/v1/cart/\".concat(id),{headers:{token:localStorage.getItem(\"tkn\")}}).then(res=>{setallProducts(res.data.data.products);setTotalPrice(res.data.data.totalCartPrice);setNumberOfCartItem(res.data.numOfCartItems);setCartId(res.data._id);setUserId(res.data.data.cartOwner);return true;}).catch(err=>{console.log(err);return false;});return boolenData;}catch(error){console.log(error);}}async function deleteCart(){try{const boolenData=await axios.delete(\"https://ecommerce.routemisr.com/api/v1/cart\",{headers:{token:localStorage.getItem(\"tkn\")}}).then(res=>{setNumberOfCartItem(0);setTotalPrice(0);setallProducts(0);setCartId(null);return true;}).catch(err=>{console.log(err);return false;});return boolenData;}catch(error){console.log(error);}}return/*#__PURE__*/_jsx(addCart.Provider,{value:{addProductToCart,getProductFromCart,numberOfCartItem,totalPrice,allProducts,cartId,userId,updateProductToCart,deleteItemFromCart,deleteCart},children:children});}","map":{"version":3,"names":["axios","React","createContext","useContext","useEffect","useState","tokenContext","jsx","_jsx","addCart","AddProductToCartProvider","_ref","children","token","numberOfCartItem","setNumberOfCartItem","totalPrice","setTotalPrice","allProducts","setallProducts","cartId","setCartId","userId","setUserId","getProductFromCart","get","headers","localStorage","getItem","then","res","data","products","totalCartPrice","numOfCartItems","_id","cartOwner","setItem","err","console","error","addProductToCart","productId","post","Error","updateProductToCart","id","newCount","boolenflag","put","concat","count","catch","log","deleteItemFromCart","boolenData","delete","deleteCart","Provider","value"],"sources":["C:/Users/Mostafa/OneDrive/Desktop/Route/final-pro/src/Context/AddProductToCart.js"],"sourcesContent":["import axios from \"axios\";\r\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\r\n\r\nimport { tokenContext } from \"./AuthContext\";\r\n\r\nexport const addCart = createContext();\r\n\r\nexport default function AddProductToCartProvider({ children }) {\r\n  const { token } = useContext(tokenContext);\r\n  const [numberOfCartItem, setNumberOfCartItem] = useState(0);\r\n  const [totalPrice, setTotalPrice] = useState(0);\r\n  const [allProducts, setallProducts] = useState(null);\r\n  const [cartId, setCartId] = useState(null);\r\n  const [userId, setUserId] = useState(null);\r\n\r\n  async function getProductFromCart() {\r\n    try {\r\n      await axios\r\n        .get(\"https://ecommerce.routemisr.com/api/v1/cart\", {\r\n          headers: { token: localStorage.getItem(\"tkn\") },\r\n        })\r\n        .then((res) => {\r\n          setallProducts(res.data.data.products);\r\n          setTotalPrice(res.data.data.totalCartPrice);\r\n          setNumberOfCartItem(res.data.numOfCartItems);\r\n          setCartId(res.data.data._id);\r\n          setUserId(res.data.data.cartOwner);\r\n          localStorage.setItem(\"userId\", res.data.data.cartOwner);\r\n        });\r\n    } catch (err) {\r\n      console.error(\"err\" + err);\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    getProductFromCart();\r\n  }, [token]);\r\n\r\n  async function addProductToCart(productId) {\r\n    try {\r\n      const { data } = await axios.post(\r\n        \"https://ecommerce.routemisr.com/api/v1/cart\",\r\n        { productId },\r\n        { headers: { token: localStorage.getItem(\"tkn\") } }\r\n      );\r\n      // setNumberOfCartItem(data.numOfCartItems);\r\n      // setTotalPrice(data.totalCartPrice);\r\n      // setallProducts(data.products);\r\n      getProductFromCart();\r\n      return data;\r\n    } catch (error) {\r\n      console.error(\"Error adding product to cart:\", error);\r\n      throw new Error(\"Failed to add product to cart\");\r\n    }\r\n  }\r\n  async function updateProductToCart(id, newCount) {\r\n    try {\r\n      const boolenflag = await axios\r\n        .put(\r\n          `https://ecommerce.routemisr.com/api/v1/cart/${id}`,\r\n          {\r\n            count: newCount,\r\n          },\r\n          {\r\n            headers: {\r\n              token: localStorage.getItem(\"tkn\"),\r\n            },\r\n          }\r\n        )\r\n        .then((res) => {\r\n          setallProducts(res.data.data.products);\r\n          setTotalPrice(res.data.data.totalCartPrice);\r\n          setNumberOfCartItem(res.data.numOfCartItems);\r\n          setUserId(res.data.data.cartOwner)\r\n          return true;\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          return false;\r\n        });\r\n      return boolenflag;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  async function deleteItemFromCart(id) {\r\n    try {\r\n      const boolenData = await axios\r\n        .delete(`https://ecommerce.routemisr.com/api/v1/cart/${id}`, {\r\n          headers: {\r\n            token: localStorage.getItem(\"tkn\"),\r\n          },\r\n        })\r\n        .then((res) => {\r\n          setallProducts(res.data.data.products);\r\n          setTotalPrice(res.data.data.totalCartPrice);\r\n          setNumberOfCartItem(res.data.numOfCartItems);\r\n          setCartId(res.data._id);\r\n          setUserId(res.data.data.cartOwner)\r\n          return true;\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          return false;\r\n        });\r\n      return boolenData;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  async function deleteCart() {\r\n    try {\r\n      const boolenData = await axios\r\n        .delete(\"https://ecommerce.routemisr.com/api/v1/cart\", {\r\n          headers: {\r\n            token: localStorage.getItem(\"tkn\"),\r\n          },\r\n        })\r\n        .then((res) => {\r\n          setNumberOfCartItem(0);\r\n          setTotalPrice(0);\r\n          setallProducts(0);\r\n          setCartId(null);\r\n          return true;\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          return false;\r\n        });\r\n      return boolenData;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <addCart.Provider\r\n      value={{\r\n        addProductToCart,\r\n        getProductFromCart,\r\n        numberOfCartItem,\r\n        totalPrice,\r\n        allProducts,\r\n        cartId,\r\n        userId,\r\n        updateProductToCart,\r\n        deleteItemFromCart,\r\n        deleteCart,\r\n      }}\r\n    >\r\n      {children}\r\n    </addCart.Provider>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}